!function(){"use strict";let e="insightcubes-iqcc-grid";class t extends HTMLElement{VIEW_STATES={VS_DEFAULT:"VS_DEFAULT",VS_DISPLAY_GRID:"VS_DISPLAY_GRID"};CURRENT_VIEW_STATE="VS_DEFAULT";EVENTS={ON_CONNECTED:"onConnected",ON_DISCONNECTED:"onDisconnected",ON_INITIALIZED:"onInitialized",ON_READY:"onReady",ITEM_CHANGED:"onItemChanged"};debugEnabled=!1;method_default="0-None";method_list=["0-None","10-Holding","20-Full","30-Equity"];items={};last_changed_item_id="";last_changed_property="";constructor(){super(),this.defineProps(),this.attachShadow({mode:"open"}).appendChild(this.getTemplate()),this.log(this.EVENTS.ON_READY),this.dispatchEvent(new CustomEvent(this.EVENTS.ON_READY,{cancelable:!1,bubbles:!0,composed:!0})),this.log(this.EVENTS.ON_INITIALIZED),this.dispatchEvent(new CustomEvent(this.EVENTS.ON_INITIALIZED,{cancelable:!1,bubbles:!0,composed:!0})),this.setViewState(this.VIEW_STATES.VS_DEFAULT),this.log("initialized")}defineProps(){this.sacWidgetName=void 0,this.sacDesignMode=void 0,this.sacMobileMode=void 0,this._props={}}onCustomWidgetBeforeUpdate(e){this._props={...this._props,...e}}onCustomWidgetAfterUpdate(e){}connectedCallback(){this.log(this.EVENTS.ON_CONNECTED),this.dispatchEvent(new CustomEvent(this.EVENTS.ON_CONNECTED,{cancelable:!1,bubbles:!0,composed:!0}))}onCustomWidgetDestroy(){this.log("onCustomWidgetDestroy")}disconnectedCallback(){this.log(this.EVENTS.ON_DISCONNECTED),this.dispatchEvent(new CustomEvent(this.EVENTS.ON_DISCONNECTED,{cancelable:!1,bubbles:!0,composed:!0}))}onCustomWidgetResize(){}getTemplate(){let e=document.createElement("template"),t=(new Date).getFullYear();return e.innerHTML=`\n                <style>\n                    :host {\n                        display: block;\n                        padding: 10px;\n                        overflow-y: auto;\n                        font-family: "lato";\n                        font-size: 12px;\n                        --clr-table-border: #ccc;\n                        --pad-table-header: 5px;\n                        --pad-table-cell: 1px;\n                        --clr-input-bg: #eee;\n                        --clr-input-bg-disabled: #ccc;\n                    }\n\n                    /* ============================== notice within body */\n\n                    div.notice{\n                        padding: 10px 0px;\n                        text-align: left;\n                        font-size: 120%;\n                        font-weight: bold;\n                    }\n\n                    /* ============================== header */\n\n                    #section--header{\n                        text-align: left;\n                        color: #888;\n                        margin-top: 0.25rem;\n                        font-size: 65%;\n                        font-weight: bold;\n                        margin-bottom: 0.5rem;\n                    }\n\n                    #section--header a{\n                        color: #39489d;\n                        text-decoration: none;\n                    }\n\n                    /* ============================== controls */\n\n                    #section--controls{\n                        padding: 0.5rem 0;\n                    }\n\n                    /* ============================== status */\n\n                    #section--status{\n                        text-align: left;\n                        color: #888;\n                        font-size: 80%;\n                    }\n\n                    /* ============================== buttons */\n\n                    .btn--base{\n                        padding: 0.5rem;\n                        vertical-align: top;\n                        border: 1px solid #ababab;\n                        border-radius: 0.2rem;\n                        outline: 0;\n\n                        background-color: rgb(247, 247, 247);\n                        border-color: rgb(191, 191, 191);\n                        color: rgb(52, 97, 135);\n                        cursor: pointer;\n                    }\n\n                    .btn--base:hover{\n                        background-color: rgb(219, 215, 215);\n                    }\n\n                    /* ============================== table */\n\n                    .form-control,\n                    .form-control ::before,\n                    .form-control ::after {\n                      border: none;\n                      background-image: none;\n                      background-color: transparent;\n                      -webkit-box-shadow: none;\n                      -moz-box-shadow: none;\n                      box-shadow: none;\n                    }\n              \n                    table.iqcc_grid_table {\n                      table-layout: fixed;\n                      width: 100%;\n                      border-collapse: collapse;\n                      border: 1px solid var(--clr-table-border);\n                      scrollbar-width: thin;\n                      scroll-behavior: auto;\n                    }\n              \n                    table.iqcc_grid_table th,\n                    td {\n                      text-align: center;\n                      border: 1px solid var(--clr-table-border);\n                      padding: 0px;\n                    }\n              \n                    table.iqcc_grid_table th {\n                      padding: var(--pad-table-header);\n                    }\n              \n                    table.iqcc_grid_table td {\n                      padding: var(--pad-table-cell);\n                      text-align: center;\n                    }\n\n                    table.iqcc_grid_table td div.input-container{\n                        display: flex;\n                    }\n\n                    table.iqcc_grid_table td.input-cell {\n                    }\n\n                    table.iqcc_grid_table td.input-cell div.unit {\n                        background-color: var(--clr-input-bg);\n                        padding-right: 3px;\n                        padding-left: 1px;\n                        align-items: center;\n                        display: flex;\n                        font-weight: bold;\n                        font-size: 90%;\n                        color: #777;\n                      }\n\n                    table.iqcc_grid_table td.input-cell div.unit.dark{\n                        background-color: var(--clr-input-bg-disabled);\n                    }\n              \n                    .form-control {\n                      width: 100%;\n                      padding: 5px 4px;\n                      margin: 0;\n                      border-radius: 0;\n                      height: 2rem;\n                      background-color: var(--clr-input-bg);\n                      box-sizing: border-box;\n                      display: inline;\n                    }\n\n                    .form-control[disabled]{\n                        background-color: var(--clr-input-bg-disabled);\n                    }\n\n                    .form-control[type="text"]{\n                        text-align: right;\n                    }\n              \n                    .form-control:focus {\n                      border: none;\n                      box-shadow: none;\n                      outline: 1px solid rgb(114, 177, 236);\n                    }\n              \n                    table.iqcc_grid_table td.cell-text {\n                      padding: 5px;\n                      text-align: left;\n                    }\n                </style>\n\n                <div>\n                    <div id="section--header">\n                        &copy; ${t} <a href="https://insightcubes.com" target="_blank">Insight Cubes</a>\n                    </div>\n\n                    <div id="section--status"></div>\n                    <div id="section--controls"></div>\n\n                    <div id="section--body">\n                        <div class="notice">Loading</div>\n                    </div>\n                </div>\n            `,e.content.cloneNode(!0)}log(...t){this.debugEnabled&&console.log("["+e+"] ",...t)}getCurrentViewState(){return this.CURRENT_VIEW_STATE||(this.CURRENT_VIEW_STATE=this.VIEW_STATES.VS_DEFAULT),this.CURRENT_VIEW_STATE}setViewState(e){"string"==typeof e&&Object.keys(this.VIEW_STATES).includes(e)||this.log("attempted to set invalid view state: ",e);let t=this.CURRENT_VIEW_STATE;t===e?this.log("view state rerender:",this.CURRENT_VIEW_STATE):(this.CURRENT_VIEW_STATE=e,this.log("view state change:",t,"to",this.CURRENT_VIEW_STATE)),this.render()}setDebugEnabled(e){this.debugEnabled=!!e,this.render()}setMethods(e){if(!Array.isArray(e))return!1;if(e.length<1)return!1;for(let t of e)if("string"!=typeof t)return!1;this.method_list=[];for(let t of e)this.method_list.includes(t)||this.method_list.push(t);return!0}setDefaultMethod(e){return!("string"!=typeof e||!this.method_list.includes(e))&&(this.method_default=e,!0)}clearItems(){this.items={},this.log("items cleared"),this.setViewState(this.VIEW_STATES.VS_DEFAULT),this.last_changed_item_id="",this.last_changed_property=""}addItem(e,t,n,i,s="0.00",o="0.00",d="0.00",r="0.00"){if(!e)return!1;if(!t)return!1;if(n||(n=this.method_default),i||(i=this.method_default),!this.method_list.includes(n))return!1;if(!this.method_list.includes(i))return!1;let a={id:e,name:t,meth_sys:n,meth_user:i,cons_sys:"string"==typeof s?s:s.toString(),cons_user:"string"==typeof o?o:o.toString(),own_sys:"string"==typeof d?d:d.toString(),own_user:"string"==typeof r?r:r.toString()};return this.items[e]={...a},this.log(""),this.render(),!0}dataReady(){return this.processItems(),!(Object.keys(this.items).length<1)&&(this.setViewState(this.VIEW_STATES.VS_DISPLAY_GRID),this.log(`dataReady (${Object.keys(this.items).length} items)`),!0)}getChangedItemId(){return this.last_changed_item_id}getChangedProperty(){return this.last_changed_property}getItemName(e){return e in this.items&&this.items[e].name||""}getItemMethod(e){return e in this.items&&this.items[e].meth_user||""}getItemConsolidation(e){return e in this.items&&this.items[e].cons_user||""}getItemOwnership(e){return e in this.items&&this.items[e].own_user||""}getItemIds(){return Object.keys(this.items)}processItems(){}getSelectOptions(e){let t=[];for(let n of this.method_list){let i=document.createElement("option");i.setAttribute("value",n),n===e&&i.setAttribute("selected","selected"),i.innerHTML=n,t.push(i)}return t}getTableRowDom(e){if(!(e in this.items))return!1;let t=this.items[e],n=this,i=document.createElement("div");i.className="unit",i.innerHTML="%";let s=document.createElement("div");s.className="input-container";let o=document.createElement("tr");o.setAttribute("data-id",t.id);let d=document.createElement("td");d.className="cell-text",d.innerHTML=t.name,o.appendChild(d);let r=document.createElement("td");r.className="input-cell";let a=document.createElement("select");a.className="form-control",a.setAttribute("data-id",t.id),a.setAttribute("name",t.id+"--meth_sys"),a.setAttribute("disabled",!0);for(let e of this.getSelectOptions(t.meth_sys))a.appendChild(e);a.setAttribute("value",t.meth_sys),r.appendChild(a),o.appendChild(r);let l=document.createElement("td");l.className="input-cell";let c=document.createElement("select");c.className="form-control",c.setAttribute("data-id",t.id),c.setAttribute("name",t.id+"--meth_user");for(let e of this.getSelectOptions(t.meth_user))c.appendChild(e);a.setAttribute("value",t.meth_user),c.addEventListener("change",(function(t){n.items[e].meth_user=t.target.value,n.last_changed_item_id=e,n.last_changed_property="meth_user",n.onInputChange()})),l.appendChild(c),o.appendChild(l);let h=document.createElement("td");h.className="input-cell";let u=document.createElement("input");u.className="form-control",u.setAttribute("data-id",t.id),u.setAttribute("name",t.id+"--cons_sys"),u.setAttribute("type","text"),u.setAttribute("value",t.cons_sys),u.setAttribute("disabled",!0);let m=s.cloneNode(!0);m.appendChild(u),i.className="unit dark",m.appendChild(i.cloneNode(!0)),h.appendChild(m),o.appendChild(h);let p=document.createElement("td");p.className="input-cell";let _=document.createElement("input");_.className="form-control",_.setAttribute("data-id",t.id),_.setAttribute("name",t.id+"--cons_user"),_.setAttribute("type","text"),_.setAttribute("value",t.cons_user),_.addEventListener("input",(function(t){n.items[e].cons_user=t.target.value,n.last_changed_item_id=e,n.last_changed_property="cons_user",n.onInputChange()}));let g=s.cloneNode(!0);g.appendChild(_),i.className="unit",g.appendChild(i.cloneNode(!0)),p.appendChild(g),o.appendChild(p);let b=document.createElement("td");b.className="input-cell";let E=document.createElement("input");E.className="form-control",E.setAttribute("data-id",t.id),E.setAttribute("name",t.id+"--own_sys"),E.setAttribute("type","text"),E.setAttribute("value",t.own_sys),E.setAttribute("disabled",!0);let T=s.cloneNode(!0);T.appendChild(E),i.className="unit dark",T.appendChild(i.cloneNode(!0)),b.appendChild(T),o.appendChild(b);let y=document.createElement("td");y.className="input-cell";let f=document.createElement("input");f.className="form-control",f.setAttribute("data-id",t.id),f.setAttribute("name",t.id+"--own_user"),f.setAttribute("type","text"),f.setAttribute("value",t.own_user),f.addEventListener("input",(function(t){n.items[e].own_user=t.target.value,n.last_changed_item_id=e,n.last_changed_property="own_user",n.onInputChange()}));let N=s.cloneNode(!0);return N.appendChild(f),i.className="unit",N.appendChild(i.cloneNode(!0)),y.appendChild(N),o.appendChild(y),o}validatePercentage(e){if(""===e||"string"!=typeof e||void 0===e)return!0;let t=parseFloat(e);return!isNaN(t)&&(t>=0&&t<=100)}onInputChange(){let e=this.getChangedItemId(),t=this.getItemMethod(e),n=this.getItemOwnership(e),i=this.getItemConsolidation(e);if(e){if(!this.method_list.includes(t))return void this.log("! invalid method",t);if(!this.validatePercentage(n))return void this.log("! invalid ownerhsip %",n);if(!this.validatePercentage(i))return void this.log("! invalid consolidation %",i);this.dispatchEvent(new CustomEvent(this.EVENTS.ITEM_CHANGED,{cancelable:!1,bubbles:!0,composed:!0}))}else this.log("! no item id")}render(){switch(this.prerender(),this.CURRENT_VIEW_STATE){case this.VIEW_STATES.VS_DEFAULT:this.render_VS_DEFAULT();break;case this.VIEW_STATES.VS_DISPLAY_GRID:this.render_VS_DISPLAY_GRID();break;default:this.render_STATE_DEFAULT()}this.postrender()}prerender(){this.getBodyElement().innerHTML="",this.updateStatus(),this.getControlsElement().innerHTML=""}postrender(){}render_VS_DEFAULT(){let e=this.getBodyElement();this.displayMessage&&(e.innerHTML=`<div class="notice">${this.displayMessage}</div>`)}render_VS_DISPLAY_GRID(){this.getBodyElement().innerHTML='\n            <table class="iqcc_grid_table">\n                <thead>\n                <tr>\n                    <th rowspan="2">Entity</th>\n                    <th colspan="2">Consolidation Method</th>\n                    <th colspan="2">Consolidation Rate</th>\n                    <th colspan="2">Ownership Rate</th>\n                </tr>\n                <tr>\n                    <th>Generated</th>\n                    <th>Current</th>\n                    <th>Generated</th>\n                    <th>Current</th>\n                    <th>Generated</th>\n                    <th>Current</th>\n                </tr>\n                </thead>\n                <tbody id="tableBody">\n                </tbody>\n            </table>\n        ';let e=this.shadowRoot.getElementById("tableBody");if(!e)return;let t=Object.keys(this.items);t.sort(((e,t)=>this.items[e].name<this.items[t].name?-1:this.items[e].name>this.items[t].name?1:0));for(let n of t){let t=this.getTableRowDom(n);t&&e.appendChild(t)}}getBodyElement(){return this.shadowRoot.getElementById("section--body")}getControlsElement(){return this.shadowRoot.getElementById("section--controls")}clearBodyElement(){let e=this.getBodyElement();e&&(e.innerHTML="")}updateStatus(){if(!this.debugEnabled)return;let e=this.shadowRoot.getElementById("section--status");e&&(e.innerHTML=`DEBUG: ${this.CURRENT_VIEW_STATE} `)}getSampleData(){return[{id:"e1",name:"Entity 8",meth_sys:"0-None",meth_user:"0-None",cons_sys:"0.00",cons_user:"0.00",own_sys:"0.00",own_user:"0.00"},{id:"e2",name:"Entity 6",meth_sys:"10-Holding",meth_user:"10-Holding",cons_sys:"0.00",cons_user:"10.10",own_sys:"0.00",own_user:"20.20"},{id:"e3",name:"Entity 4",meth_sys:"20-Full",meth_user:"20-Full",cons_sys:"0.00",cons_user:"30.03",own_sys:"0.00",own_user:"40.04"},{id:"e4",name:"Entity 2",meth_sys:"30-Equity",meth_user:"30-Equity",cons_sys:"0.00",cons_user:"51.00",own_sys:"0.00",own_user:"67.89"}]}}customElements.define(e,t)}();
